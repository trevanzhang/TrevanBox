---
name: writing-diary
description: Use when users want to create, update, or enhance daily journal entries in TrevanBox system - provides structured approach for locating journal files, applying templates, managing metadata, and guiding content creation
---

# 写日志技能

## 概述

基于TrevanBox系统的PARA个人知识管理方法，提供系统化的日记创建和维护功能。自动化文件管理、模板应用和内容结构化，深度集成PARA工作流。

**重要：此技能必须使用自定义日记模板**
- 模板位置：`.claude/skills/writing-diary/examples/diary.md`
- 禁止使用其他模板文件
- 模板使用是强制性的，不可跳过

## 使用时机

**使用时机：**
- 用户说"写日记"、"完善日记"、"记录想法"、"更新日记"
- 用户想要创建今天的日记条目
- 用户需要帮助结构化日记内容
- 用户想要添加元数据并与现有PARA系统建立连接

**不要使用：**
- 日记上下文之外的一般笔记记录
- 项目特定的文档编写
- 资源收集和组织

## 核心模式

**之前：** 单次日记创建，缺乏历史连续性和数据一致性
**之后：** 连续性日记系统，回顾昨天、记录今天、规划明天，建立完整的生活改进循环

## 快速参考

| 步骤 | 操作 | 工具/命令 |
|------|--------|--------------|
| 1 | 定位/创建今天的日记文件 | `Glob` + `Read`/`Write` |
| 2 | **历史回顾**（新增） | 读取昨天日记的明日计划 |
| 3 | **智能时间处理**（新增） | 处理跨日期日记创建 |
| 4 | **强制使用自定义模板** | `.claude/skills/writing-diary/examples/diary.md` |
| 5 | **闪念整合检查（必备）** | 检查fleeting目录中的当天闪念 |
| 6 | 引导内容收集 | 交互式提问 |
| 7 | **数据一致性检查**（新增） | 同步frontmatter和正文数据 |
| 8 | 更新元数据 | Frontmatter管理 |
| 9 | **明日计划提醒**（新增） | 检查并提醒明日计划 |
| 10 | 创建PARA连接 | 链接创建 |
| 11 | 智能内容分析 | 关键词提取和分类 |

## 实现细节

### 1. 文件定位和创建

```bash
# 日记目录结构（基于实际使用）
2-Areas/Personal-Growth/journal/YYYY-MM-DD.md
```

**自动化文件管理：**
- 检查今天的日记是否存在
- 如果缺失则从模板创建
- 读取现有内容进行更新
- 确保正确的文件路径

### 2. 历史回顾功能（新增）

**昨日计划检查：**
- 自动读取昨天的日记文件
- 提取"💡 明日计划"部分内容
- 询问用户计划的完成情况
- 根据完成情况给予适当反馈

**实现流程：**
1. **文件检查**：查找昨天的日记文件（YYYY-MM-DD-1.md）
2. **内容提取**：读取"明日计划"部分的待办事项
3. **互动询问**：逐一询问每项计划的完成情况
4. **情感反馈**：根据完成情况询问用户感受
5. **经验总结**：帮助用户发现计划执行中的模式

**回顾问题示例：**
- "昨天你计划了[X]，完成得怎么样？"
- "在完成计划的过程中有什么感受？"
- "是什么帮助或阻碍了计划的完成？"
- "从昨天的经验中，有什么可以改进的地方吗？"

**价值体现：**
- 建立日记间的连续性和横向联系
- 形成"计划-执行-回顾"的闭环
- 增强成就感和责任感
- 发现个人行为模式和改进机会

### 3. 智能时间处理（新增）

**跨日期处理：**
- 检测当前时间，判断用户意图
- 深夜写日记时的日期归属询问
- 灵活处理时区和时间偏好

**智能询问：**
- "现在是[时间]，您是想写今天的日记还是明天的日记？"
- "如果超过晚上10点，是否算作明天的日记？"
- "您希望这个日记记录属于哪一天？"

**处理逻辑：**
1. **时间检测**：获取当前系统时间
2. **阈值判断**：设定时间阈值（如22:00）
3. **用户确认**：询问日期归属意图
4. **文件创建**：根据用户选择创建对应日期的日记文件

### 4. 闪念整合（必备检查，条件整合）

**智能闪念处理：**
- **必备检查**：每次创建/更新日记时必须检查fleeting目录
- **当天闪念**：通过文件属性判断是否为当天创建的闪念
- **条件整合**：有闪念则整合到日记，无闪念则跳过整合步骤
- **领域分类**：按工作、健康、财富、学习等领域分组
- **内容整合**：将闪念内容整合到日记的"今日闪念"部分
- **文件清理**：整合完成后自动删除原始闪念文件

**闪念整合工作流：**
1. **必备检查**：检查fleeting目录中是否有当天闪念（通过文件属性判断）
2. **条件执行**：有闪念则执行整合流程，无闪念则跳过后续步骤
3. **内容读取**：读取闪念文件内容和元数据
4. **领域分类**：按area字段分类闪念内容
5. **整合写入**：将闪念内容写入日记的"今日闪念"部分
6. **PARA连接**：基于闪念内容创建相关PARA连接
7. **文件清理**：删除已整合的闪念文件

**闪念文件要求：**
- **位置**：`fleeting/`目录下
- **元数据**：包含`area`字段（工作、健康、财富、学习等）
- **创建时间**：当天创建的闪念文件
- **格式**：标准markdown文件

**闪念整合优势：**
- **信息完整性**：必备检查确保所有当天闪念都能被发现
- **智能处理**：条件整合避免不必要的空段落
- **行动转化**：通过PARA连接将想法转化为行动
- **空间清理**：避免fleeting目录积累过多文件
- **直觉体验**：符合"记录-整合-清理"的自然工作流

### 5. 模板应用

**强制使用自定义模板**：
- **模板路径**：`.claude/skills/writing-diary/examples/diary.md`
- **使用要求**：必须使用此模板，禁止使用其他模板
- **验证步骤**：每次创建日记前检查是否使用正确模板

自定义模板包含：
- 标准frontmatter（日期、心情、精力、标签）
- 结构化部分（今日核心、高光时刻、成长收获、深度思考）
- 中文语言格式
- PARA系统集成
- 创意灵感和人际互动记录

**模板强制使用规则**：
1. 创建新日记时必须从自定义模板开始
2. 更新现有日记时需确保结构符合自定义模板
3. 如果模板不存在，必须创建模板后再继续
4. 禁止使用系统默认模板或其他替代方案

### 6. 内容引导

**交互式提问：**
- "今天有什么特别的事情发生吗？"
- "今天完成了哪些重要事项？"
- "有什么新的想法或感悟？"
- "心情和精力状态如何？"
- "有什么值得记录的时间节点吗？"
- "今天的学习或工作进展如何？"

**深度情绪追踪（新增）：**
- "今天的心情如何？有什么特别影响心情的事情吗？"
- "是什么让你感到开心/沮丧/焦虑/平静？"
- "这种情绪让你有什么新的感悟？"
- "你觉得今天的心情对你有什么影响？"

**精力规律分析（新增）：**
- "今天的精力水平如何？（1-10分）"
- "什么时候你感觉精力最充沛？什么时候比较疲惫？"
- "什么事情消耗了你的精力？什么事情给你充电？"
- "你发现了自己的什么精力模式吗？"

**内容结构化：**
- 将回答映射到模板部分
- 从内容中提取关键词作为标签
- 识别与Projects/Areas/Resources的连接
- 创建时间线记录

### 7. 数据一致性检查（新增）

**frontmatter与正文同步：**
- **心情字段**：用户在正文中填写的心情同步到`mood`字段
- **天气字段**：用户填写的天气信息同步到`weather`字段
- **精力字段**：用户填写的精力水平同步到`energy_level`字段

**同步逻辑：**
1. **内容检测**：识别用户在正文中填写的相关信息
2. **数据提取**：从正文中提取具体数值或描述
3. **字段更新**：自动更新对应的frontmatter字段
4. **一致性验证**：确保frontmatter和正文内容一致

**实现示例：**
- 用户填写"心情：开心" → `mood: 开心`
- 用户填写"天气：晴朗" → `weather: 晴朗`
- 用户填写"精力水平：7" → `energy_level: 7`

**数据流向：**
```
用户输入 → 正文内容填写 → 自动提取并同步到frontmatter
```

**价值体现：**
- 确保数据完整性和一致性
- 提高数据的可用性和可搜索性
- 避免重复填写和信息遗漏
- 提升用户体验

### 8. 元数据管理

**自动更新字段：**
- `updated` 时间戳
- `mood` 和 `energy_level` 从用户输入获取
- `tags` 从内容关键词生成
- `focus_areas` 从提及的主题提取
- `area` 固定为 "Personal-Growth"

**PARA深度集成：**
- 链接到相关项目
- 连接到领域进行维护
- 引用资源进行学习
- 建议将想法转化为行动

### 9. 明日计划提醒（新增）

**计划检查机制：**
- 在日记生成尾声检查"💡 明日计划"部分
- 识别空白或未填写的情况
- 委婉提醒用户思考明天的计划

**提醒策略：**
- **非强制性**：以建议而非要求的方式提醒
- **情境相关**：基于今日内容给出具体建议
- **时间敏感**：考虑明天的工作日/周末属性

**提醒示例：**
- "我看到明天的计划部分还是空的，有什么想要为明天准备的吗？"
- "基于今天的经历，明天有什么特别想要关注或改进的地方吗？"
- "明天是[星期X]，有什么重要的事情需要提前计划吗？"
- "从今天的记录来看，有什么想要明天继续跟进的事情吗？"

**智能建议：**
- 基于今日未完成事项建议明日跟进
- 根据今日情绪和精力状态建议明日活动
- 结合今日PARA连接建议相关行动

**价值体现：**
- 培养用户的规划意识和前瞻性思维
- 建立今天反思与明天规划的联系
- 让日记更好地服务于实际生活改进
- 形成持续的改进循环

### 10. 模板灵活性（新增）

**模式选择：**
- **完整模式**：使用标准模板，包含所有部分和深度引导
- **快速模式**：简化版本，聚焦核心内容，适合时间紧张时使用

**快速模式特点：**
- 简化的模板结构
- 聚焦当日重要事项
- 减少深度思考问题
- 保持基本元数据完整性

**模式询问：**
- "您希望使用完整模式还是快速模式来写今天的日记？"
- "如果时间紧张，可以选择快速模式，只记录最重要的内容"
- "完整模式会提供更深入的思考和引导"

**实现逻辑：**
1. **模式询问**：在开始时询问用户偏好的模式
2. **模板适配**：根据选择使用对应的简化模板
3. **引导调整**：快速模式下减少深度问题的数量
4. **功能保留**：核心功能（闪念整合、PARA连接等）保持不变

**价值体现：**
- 提高技能的适用性和灵活性
- 适应不同时间状况和用户需求
- 降低使用门槛，提高使用频率
- 保持结构化的同时提供便利性

### 11. 智能内容分析

**关键词提取：**
- 从用户描述中识别重要概念
- 自动建议相关标签
- 识别潜在的项目机会
- 发现与现有内容的连接点

**内容质量检查：**
- 验证文件路径正确性
- 检查frontmatter完整性
- 验证内容结构
- 确认PARA连接

## 示例

### 示例1：新日记创建

**用户：** "我想写今天的日记"

**技能应用：**
1. 定位/创建：`2-Areas/Personal-Growth/journal/2025-10-18.md`
2. **强制模板检查**：验证使用 `.claude/skills/writing-diary/examples/diary.md`
3. 应用模板：使用自定义模板结构
4. 引导内容："请告诉我今天发生了什么特别的事情？"
5. 更新元数据：从回答中提取心情、精力、标签
6. 创建连接：链接到相关Projects/Areas
7. 智能分析：识别关键词并建议相关连接

**结果：** 完整的日记条目，基于自定义模板，包含结构化内容和PARA集成

### 示例2：日记更新

**用户：** "完善今天的日记"

**技能应用：**
1. 定位现有：读取 `2025-10-18.md`
2. 识别空白：检查空的部分
3. 引导完成："我看到今日重点部分还是空的，有什么计划要添加吗？"
4. 更新元数据：刷新 `updated` 时间戳
5. 增强连接：基于内容添加新链接
6. 时间线记录：记录重要时间节点

**结果：** 增强的日记条目，包含完整部分

### 示例3：内容结构化

**用户：** "今天测试了Obsidian，感觉功能更强了"

**技能应用：**
1. 提取关键词："Obsidian"、"功能增强"
2. 结构化内容：添加到"今日思考"部分
3. 更新标签：添加 `[Obsidian, 工具学习]`
4. 创建连接：链接到相关Resources
5. 建议行动："这个发现可以转化为学习项目吗？"
6. 时间记录：记录测试的具体时间

**结果：** 结构化内容，包含可发现的元数据

### 示例4：闪念整合

**场景：** 用户有多个当天闪念文件需要整合到日记

**技能应用：**
1. **闪念检查**：自动检查fleeting目录中的当天闪念文件
2. **领域分类**：按工作、健康、财富、学习等领域分组闪念
3. **内容整合**：将闪念内容写入日记的"今日闪念"部分
4. **PARA连接**：基于闪念内容创建相关项目、领域、资源连接
5. **文件清理**：整合完成后自动删除原始闪念文件

**闪念整合结果：**
- **工作领域**：项目想法 → 转化为新项目
- **健康领域**：健康提醒 → 更新健康管理领域
- **财富领域**：投资想法 → 调整财富管理规划
- **学习领域**：技术笔记 → 添加到学习资源

**结果：** 完整的日记条目，包含整合的闪念内容和自动创建的PARA连接，同时清理了fleeting目录

## 常见错误

**❌ 手动文件创建：** 创建不一致的路径和格式
**✅ 使用自动化定位：** 确保标准结构

**❌ 使用错误模板：** 使用系统默认模板或其他模板
**✅ 强制使用自定义模板：** 必须使用 `.claude/skills/writing-diary/examples/diary.md`

**❌ 跳过模板检查：** 未验证是否使用正确模板
**✅ 每次验证模板：** 确保使用指定的自定义模板

**❌ 无结构内容：** 难以回顾和连接
**✅ 遵循模板：** 提供一致的组织

**❌ 缺少元数据：** 限制搜索和分析
**✅ 自动填充字段：** 启用系统集成

**❌ 忽略PARA连接：** 将日记与系统隔离
**✅ 创建相关链接：** 与知识网络集成

**❌ 缺少时间记录：** 难以追踪事件顺序
**✅ 记录时间线：** 提供事件的时间上下文

**❌ 忽略闪念检查：** 可能遗漏重要的闪念信息
**✅ 必备闪念检查：** 每次日记操作都检查fleeting目录

**❌ 强制闪念整合：** 即使无闪念也添加空段落
**✅ 条件闪念整合：** 有闪念则整合，无闪念则跳过

**❌ 手动闪念管理：** 需要手动复制粘贴闪念内容
**✅ 智能闪念整合：** 自动读取、分类、整合闪念内容

## 实际影响

- **时间节省：** 日记创建速度提升5倍
- **一致性：** 所有条目采用标准化格式
- **可发现性：** 丰富的元数据支持强大查询
- **集成性：** 与PARA工作流无缝连接
- **反思质量：** 结构化提示鼓励深度思考
- **行动转化：** 将想法转化为具体项目

---

**技能版本：** 1.4
**最后更新：** 2025-10-19
**兼容系统：** TrevanBox v1.2.1

## 更新说明

### v1.4 (2025-10-19)
- **历史回顾功能**：自动读取昨日日记的明日计划，询问完成情况和感受
- **智能时间处理**：处理深夜写日记的日期归属问题，智能询问用户意图
- **数据一致性检查**：自动同步frontmatter和正文数据（心情、天气、精力水平）
- **深度情绪追踪**：不仅记录情绪，还探索情绪变化的原因和影响
- **精力规律分析**：帮助用户发现个人精力模式和高低精力时段
- **明日计划提醒**：委婉提醒用户填写明日计划，基于当日内容给出建议
- **模板灵活性**：提供完整模式和快速模式选择，适应不同使用场景
- **增强的连续性**：建立日记间的横向联系，形成"计划-执行-回顾"闭环
- **智能交互优化**：更贴合常识的问答体验，增强日记的实用性

### v1.3 (2025-10-19)
- **闪念整合功能**：必备检查、条件整合、自动清理fleeting目录中的当天闪念
- **智能逻辑判断**：每次必检查，有闪念则整合，无闪念则跳过
- **领域分类整合**：按工作、健康、财富、学习等领域分组闪念内容
- **PARA连接创建**：基于闪念内容自动创建相关项目、领域、资源连接
- **文件自动清理**：整合完成后自动删除原始闪念文件

### v1.2 (2025-10-19)
- **强制自定义模板**：必须使用 `.claude/skills/writing-diary/examples/diary.md`
- **模板验证机制**：每次操作前检查模板使用
- **自定义模板创建**：添加专门的日记模板文件
- **模板使用规则**：明确禁止使用其他模板

### v1.1 (2025-10-18)
- **修正文件路径**：更新为实际使用的日记目录结构
- **增强内容引导**：添加更多交互式提问选项
- **改进PARA集成**：加强项目、领域、资源的连接
- **添加时间线记录**：支持事件时间节点记录
- **智能内容分析**：关键词提取和分类建议
- **中文优化**：完全中文化的技能文档

### v1.0 (2025-10-18)
- 初始版本发布
- 基础日记创建和更新功能
- 标准模板应用
- 基础PARA集成